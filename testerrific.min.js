function binding(obj,property){let _this=this;if(_this.has_init=!1,_this.value=obj[property],"object"==typeof obj[property]&&null!==obj[property]&&Object.keys(obj[property]).length){let t=Object.keys(obj[property]);for(let e=0;e<t.length;e++)new binding(obj[property],t[e])}_this.getter=function(){return _this.value},_this.setter=function(t){_this.value=t,_this.has_init&&updateDOM(),_this.has_init=!0};let props={get:this.getter,set:this.setter};if(Object.defineProperty(obj,property,props),Array.isArray(obj[property])){const array_methods=["push","pop","unshift","shift","splice","sort","reverse"];array_methods.forEach((function(method){Object.defineProperty(obj[property],method,{value:function(...args){let _array=qt.clone(this);eval("_array."+method+"(...args)");for(let t=this.length-1;t>=0;t--)delete this[t];this.length=_array.length,obj[property]=Object.assign(this,_array)}})}))}obj[property]=this.value}function bind_qt(){for(let t in qt)"function"!=typeof qt[t]&&new binding(qt,t);updateDOM()}qt={collapse_skipped_groups:!0,groups:[],visible:!0,current_group:-1,running_group:-1,current_test:0,running:0,paused:0,run_start:0,run_time:0,is_manual_test:1,skip_manual_tests:0,dom_check_timeout:2e3,dom_check_interval:100,test_defaults:{running:0,time:null,result:null,skip:0,only:0,max_time:1e3,run_if:"",message:"",before:()=>{},after:()=>{}},test_group:function(t,e={}){qt.groups.push(Object.assign({group:!0,label:t,test_count:0,collapse:!1,tests:[],skip:0,only:0,run_if:"",beforeEach:()=>{},afterEach:()=>{}},e))},duplicate_group:function(t,e,r={}){let s=qt.find(qt.groups,{label:t}),n=qt.clone(s);return n=_.defaults(r,n),n.label=e,qt.groups.push(n),qt.groups.length-1},test:function(t,e,r={}){"object"!=typeof e&&e||(r=e,e=t,t=null);let s=Object.assign(qt.clone(qt.test_defaults),r,{test:e});!s.label&&t&&(s.label=t),s.label||"string"!=typeof e||(s.label=e);let n=qt.groups[qt.groups.length-1];"number"==typeof s.group?n=qt.groups[s.group]:s.group&&(n=qt.find(qt.groups,{label:s.group})),s.position?n.tests.splice(s.position,0,s):n.tests.push(s)},run:function(t,e,r={}){"object"!=typeof e&&e||(r=e,e=t,t=null),test_obj=_.defaults({fn:e},r,qt.test_defaults),!test_obj.label&&t&&(test_obj.label=t);let s=qt.groups[qt.groups.length-1];"number"==typeof test_obj.group?s=qt.groups[test_obj.group]:test_obj.group&&(s=qt.find(qt.groups,{label:test_obj.group})),test_obj.position?s.tests.splice(test_obj.position,0,test_obj):s.tests.push(test_obj)},wait:function(t){qt.run((()=>new Promise((function(e,r){setTimeout(e,t)}))))},pause:function(){qt.run((function(){qt.alert("Tests paused."),qt.pause_tests()}))},manual_test:function(t="",e="",r={}){"object"!=typeof e&&e||(r=e,e=t),test_obj=_.defaults({label:t,test:"false",max_time:999999,message:e,is_manual_test:1},r,qt.test_defaults),qt.test(t,test_obj)},disable_skipped_tests:function(){let t=0;qt.groups.forEach((function(e){e.tests.forEach((function(r){(e.only||r.only)&&(t=1)}))})),qt.groups.forEach((function(e){let r=0,s=0;e.tests.forEach((function(n){e.skip&&(n.skip=1),n.only&&(s=1),!t||e.only||n.only||(n.skip=1),qt.skip_manual_tests&&(e.is_manual_test||n.is_manual_test)?n.skip=1:s&&(r=1)})),t&&!e.only&&(e.skip=1),qt.skip_manual_tests&&e.is_manual_test&&(e.skip=1),r&&(e.skip=0)}))},start_tests:function(t=-1){qt.groups.forEach((function(t){t.result=null,t.time=null,t.tests.forEach((function(t){t.time=null}))})),qt.running_group=t,qt.running_group>=0?(qt.current_group=qt.running_group,qt.groups[qt.current_group].tests.forEach((t=>{t.result=null}))):(qt.current_group=0,qt.groups.forEach((t=>{t.tests.forEach((e=>{t.result=null,e.result=null}))}))),qt.current_test=0,qt.running=1,qt.run_start=new Date,qt.run_time=null,qt.paused=0,qt.current_test,clearTimeout(qt.dom_check_interval_obj),qt.run_next_test()},pause_tests:function(){qt.paused=1},resume_tests:function(){qt.paused=0,qt.alert(""),qt.run_next_test()},test_start:null,dom_check_interval_obj:null,run_test:function(t,e){return new Promise((function(r,s){qt.current_group=t,qt.current_test=e;let n=qt.groups[qt.current_group],o=qt.groups[t].tests[e];o.result=null,o.time=null,o.is_manual_test?qt.is_manual_test=1:qt.is_manual_test=0,beforeEach_result=n.beforeEach(),Promise.resolve(beforeEach_result).then((function(t){before_result=o.before(),Promise.resolve(before_result).then((function(t){o.message&&qt.alert(o.message),qt.run_test_loop(qt.current_group,qt.current_test).then((function(){o.message&&qt.alert(""),after_result=o.after(),Promise.resolve(after_result).then((function(t){afterEach_result=n.afterEach(),Promise.resolve(afterEach_result).then((function(t){r()}))}))}))}))}))}))},run_test_loop:function(group_index,test_index,delay=0){return new Promise((function(resolve,reject){qt.dom_check_interval_obj=setTimeout((function(){let _group=qt.groups[qt.current_group],_test=qt.groups[qt.current_group].tests[qt.current_test];if(qt.run_start&&(qt.run_time=(new Date).getTime()-qt.run_start.getTime()),0==delay&&(qt.test_start=new Date),_test.wait_for_element&&new Date-qt.test_start>qt.dom_check_timeout)return _test.result="error",_test.error="element not found",_test.time=(new Date).getTime()-qt.test_start.getTime(),void resolve();if(_test.wait_for_element&&(!$(_test.wait_for_element).is(":visible")||$(_test.wait_for_element).css("opacity")<1))qt.run_test_loop(group_index,test_index,qt.dom_check_interval).then((function(){qt.running||(qt.current_test=0),resolve()}));else if(_test.fn)result=_test.fn(),Promise.resolve(result).then((function(t){_test.time=(new Date).getTime()-qt.test_start.getTime(),resolve()}));else{let result;if(_test.result)return _test.time=(new Date).getTime()-qt.test_start.getTime(),void resolve();try{if("function"==typeof _test.test){let t=_test.test();if(t instanceof Promise)return console.log("has promise"),void Promise.resolve(t).then((function(t){console.log("run_test_loop resolved"),_test.result=t?"passed":"failed",_test.time=(new Date).getTime()-qt.test_start.getTime(),resolve()}));result=t}else result=eval(_test.test)}catch(t){result=!1}if(!result&&_test.max_time)return void((new Date).getTime()-qt.test_start.getTime()>=_test.max_time?(_test.result="failed",_test.error="timed out",_test.time=(new Date).getTime()-qt.test_start.getTime(),resolve()):qt.run_test_loop(group_index,test_index,qt.dom_check_interval).then((function(){qt.running||(qt.current_test=0),resolve()})));_test.result=result?"passed":"failed",_test.time=(new Date).getTime()-qt.test_start.getTime(),qt.running||(qt.current_test=0),resolve()}}),delay)}))},pass_test:function(t=qt.current_group,e=qt.current_test){qt.is_manual_test=0,qt.groups[t].tests[e].result="passed"},fail_test:function(t=qt.current_group,e=qt.current_test){qt.is_manual_test=0,qt.groups[t].tests[e].result="failed"},skip_test:function(t=qt.current_group,e=qt.current_test){qt.is_manual_test=0,qt.groups[t].tests[e].result="skipped"},run_next_test:function(){if(qt.paused)return;let _group=qt.groups[qt.current_group];if(qt.current_group>=qt.groups.length||qt.running_group>=0&&qt.current_group!=qt.running_group)return void qt.finish_tests();let _test=qt.groups[qt.current_group].tests[qt.current_test];return qt.current_test>=_group.tests.length?(Vue.set(qt,"current_group",qt.current_group+1),Vue.set(qt,"current_test",0),void qt.run_next_test()):_test.skip||_test.run_if&&0==eval(_test.run_if)?(_test.result="skipped",Vue.set(qt,"current_test",qt.current_test+1),void qt.run_next_test()):void qt.run_test(qt.current_group,qt.current_test).then((function(){Vue.set(qt,"current_test",qt.current_test+1),qt.run_next_test()}))},finish_tests:function(){qt.current_group=-1,qt.current_test=0,qt.run_start=0,qt.running=0,qt.alert("Tests Complete",3e3)},alert_timeout:null,alert:function(t,e=999999){$(".tests_message span").html()!=t&&(clearTimeout(qt.alert_timeout),t?$(".tests_message span").html(t).parent().addClass("visible"):$(".tests_message span").html("").parent().removeClass("visible"),qt.alert_timeout=setTimeout((function(){qt.alert("")}),e))},find(t,e){for(var r=-1,s=0;s<t.length&&!(r>=0);s++){let n=1;for(prop in e)t[s][prop]!=e[prop]&&(n=0);n&&(r=s)}return t[r]},clone:t=>JSON.parse(JSON.stringify(t)),toggle_tests_panel(){qt.visible=!qt.visible},enable_groups(){qt.groups.forEach((t=>{t.tests.forEach((e=>{t.skip=0,e.skip=0}))}))},disable_groups(){qt.groups.forEach((t=>{t.tests.forEach((e=>{t.skip=1,e.skip=1}))}))},collapse_groups(){qt.groups.forEach((t=>{t.collapse=1}))},expand_groups(){qt.groups.forEach((t=>{t.collapse=0}))},toggle_view_group(t){qt.groups[t].collapse=!qt.groups[t].collapse},toggle_skip_group(t){let e=$(t.target).closest(".group").attr("group_index"),r=$(t.target).prop("checked");qt.groups[e].skip=!r,qt.groups[e].tests.forEach((function(t){t.skip=!r}))},toggle_skip_test(t){let e=$(t.target).closest(".group").attr("group_index"),r=$(t.target).closest(".test").attr("test_index"),s=$(t.target).prop("checked");qt.groups[e].tests[r].skip=!s},totals(t="all",e=-1){let r={all:0,run:0},s=qt.groups;return e>=0&&(s=[qt.groups[e]]),s.forEach((function(t){t.tests.forEach((function(t){t.test&&(r[t.result]||(r[t.result]=0),t.group||null==t.result||r[t.result]++,null!=t.result&&r.run++,r.all++)}))})),r[t]?r[t]:0},ms_to_s:t=>(t/1e3).toFixed(1),asdf:{a:1,b:2,c:{d:1,e:2,f:3}},df:[5,3,1,6,35,7]};var latest_qt={};function updateDOM(sub=0){resetForLoops(),updateForLoops(),$element=$(".tests_ui, .toggle_tests_panel"),$element=$element.add($element.find("*")),setTimeout((function(){$element.each((function(){if($this=$(this),$this.closest("[\\:for_model]").length)return;if($this.closest("[for_copy]")){let $parents=$this.add($this.parents());for(var y=0;y<$parents.length;y++){let $parent=$parents.eq(y);$parent.attr("item_name")&&eval("var "+$parent.attr("item_name")+" = "+JSON.stringify($parent.data($parent.attr("item_name")))+";"),$parent.attr("index_name")&&eval("var "+$parent.attr("index_name")+" = "+$parent.attr($parent.attr("index_name"))+";")}}const attrs=$this[0].getAttributeNames().reduce((function(t,e){return t[e]=$this.attr(e),t}),{});let if_val=1;if(void 0!==attrs[":else"]||attrs[":elseif"]){let $curr_el=$this.prev(),x=0;for(;$curr_el.attr(":if")||$curr_el.attr(":elseif");){try{if(if_val=eval($curr_el.attr(":if")||$curr_el.attr(":elseif")),if_val)return void $this.hide()}catch(t){console.log("else parse error:",$this)}$curr_el=$curr_el.prev()}if(attrs[":elseif"]){try{if_val=eval($this.attr(":elseif"))}catch(t){console.log("elseif parse error:",$this)}if(!if_val)return void $this.hide()}$this.show(),delete attrs[":elseif"],delete attrs[":else"]}else if(attrs[":if"]){try{if_val=eval($this.attr(":if"))}catch(t){console.log("if parse error:",$this.attr(":if"))}if(!if_val)return void $this.hide();$this.show(),delete attrs[":if"]}for(attr in attrs)if(":"==attr.substr(0,1)&&":for"!=attr)if(":text"==attr){let text_val=eval($this.attr(":text"));!1===text_val&&(text_val="false"),$this.html(text_val)}else if(":class"==attr){let class_obj={},class_str=$this.attr(attr);class_str=class_str.replace(/[{}]/g,""),class_str=class_str.split(",");for(let x=0;x<class_str.length;x++){let prop_array=class_str[x].split(":");try{class_obj[prop_array[0].trim()]=eval(prop_array[1])}catch(t){console.log(attr,"parse error:",$this,prop_array[0].trim(),prop_array[1])}}for(let t in class_obj)class_obj[t]&&$this.addClass(t),class_obj[t]||$this.removeClass(t)}else if(":style"==attr);else{let attr_val=eval($this.attr(attr));!1===attr_val&&(attr_val="false"),$this.attr(attr.substr(1),attr_val)}}))}),0)}function resetForLoops(){$("[for_copy]").remove(),$("[\\:forr]").each((function(){$(this).attr(":for",$(this).attr(":forr")),$(this).removeAttr(":forr")}))}function updateForLoops(){if($for_model=$("[\\:for]"),$for_model.length<1)return;$this=$for_model.eq(0);let model_id=Math.floor(999999999*Math.random());if($this.attr(":for_model",model_id),$this.attr(":forr",$this.attr(":for")),$this.removeAttr(":for"),$this.hide(),$this.parent().closest("[\\:for_model]").length)return;if($this.closest("[for_copy]")){let $parents=$this.add($this.parents());for(var y=0;y<$parents.length;y++){let $parent=$parents.eq(y);$parent.attr("item_name")&&eval("var "+$parent.attr("item_name")+" = "+JSON.stringify($parent.data($parent.attr("item_name")))+";"),$parent.attr("index_name")&&eval("var "+$parent.attr("index_name")+" = "+$parent.attr($parent.attr("index_name"))+";")}}let for_str=$this.attr(":forr"),item_name=for_str.substr(0,for_str.indexOf(" in ")),index_name="";item_name=item_name.replace(/[\(\)]/g,""),item_name.includes(",")&&(item_name=item_name.split(","),index_name=item_name[1].trim(),item_name=item_name[0].trim());let arr=eval(for_str.substr(for_str.indexOf(" in ")+4));for(let t=0;t<arr.length;t++)$copy=$this.clone().show(),$copy.attr("for_copy",$this.attr(":for_model")),item_name&&($copy.attr("item_name",item_name),$copy.data(item_name,arr[t])),index_name&&($copy.attr("index_name",index_name),$copy.attr(index_name,t)),$copy.removeAttr(":for"),$copy.removeAttr(":for_model"),index_name&&$copy.attr(index_name,t),index_name&&$copy.attr(index_name,t),$copy.insertBefore($this);updateForLoops()}jQuery((function(t){t("body").append('<div class="tests_app"><div is="tests_ui"></div></div>'),qt.test_group("Group A"),qt.test("a == 1"),qt.test("a == 2"),qt.test("a == 3"),qt.test_group("Group B"),qt.test("a == 1"),qt.test("a == 2"),qt.test("a == 3"),bind_qt()}));
//# sourceMappingURL=testerrific.min.js.map